<!-- Copilot / AI agent instructions for the Student Complaint Management System -->
# Quick guide for AI coding agents

This repository is a small React + Vite frontend bundle with a few Supabase serverless function files (Deno). The goal of these instructions is to prime an AI agent so it can be immediately productive: make targeted edits, add features, and follow project conventions.

Key facts (big picture)
- Frontend: React (TSX) app under `src/` with a single-page App component (`src/App.tsx`) that holds UI state and routes between views. Entry is `src/main.tsx`.
- Styling: Tailwind-like utility classes are used in `src/styles/globals.css` and component styles; many UI helpers live under `src/components/ui/`.
- Data: Local demo data lives in `src/utils/mockData.ts`. Authentication is mocked in `src/utils/auth.ts` and exposes demo credentials via `getDemoCredentials()`.
- Supabase: `src/utils/supabase/client.ts` contains a browser client used by UI code; `src/supabase/functions/server/` contains Deno serverless function code (Hono router) and an autogenerated `kv_store.tsx` helper to persist small key-value data.

Developer workflows (explicit commands)
- Install: `npm i` (project uses npm; see `package.json`).
- Dev server: `npm run dev` (Vite server, opens at port 3000 by default from `vite.config.ts`).
- Build: `npm run build` (Vite build -> `build/` directory).

Project-specific conventions and gotchas
- Mock-first: The app currently uses in-memory state and `mockComplaints` as the single source of truth. When adding persistent storage or API calls, preserve existing demo flows (keep mock data and add an opt-in integration). Example files: `src/utils/mockData.ts`, `src/App.tsx`.
- Auth: Authentication is intentionally mocked in `src/utils/auth.ts`. Use `getDemoCredentials()` for test accounts. Do not attempt to wire real auth without adding backend support.
- Supabase functions: Files in `src/supabase/functions/server/` are written for Deno runtime (see `kv_store.tsx` — autogenerated). Deploying or testing those functions requires a Deno-compatible environment and SUPABASE env vars (SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY).
- Vite aliasing: `vite.config.ts` contains custom aliases that map dependency-with-version strings to package names (e.g. `'@radix-ui/react-tooltip@1.1.8': '@radix-ui/react-tooltip'`). Prefer importing from project paths (e.g. `import X from '@/components/..'`) or the aliased package names.

Integration and cross-component patterns
- Single-page routing: `src/App.tsx` switches views by local state `currentView`. Components receive callbacks for navigation, state updates, and user context. Example: `StudentDashboard` receives `onNavigate`, `onLogout`.
- State shape: The `Complaint` and `User` types are declared in `src/App.tsx` and used across components. When adding fields, update these types and the mock data.
- Notifications: Browser Notification API is invoked in `src/App.tsx` for admin critical alerts — guard with permission checks and role checks.

What an AI agent should do first (task contract)
- Inputs: A small change request (bugfix, feature, or refactor). Use local files only. If new secrets/env are required, do not commit them — request guidance.
- Outputs: Minimal, working edits with unit smoke-checks (build/dev server start). Keep changes small and update types and mock data accordingly.
- Error modes: Look for TypeScript/TSX compiler errors after edits. Prefer minimal, local fixes.

Concrete examples to guide edits
- Adding a new demo complaint: update `src/utils/mockData.ts` and adjust type `Complaint` in `src/App.tsx` if adding fields.
- Wire a new API call: add client code under `src/utils/supabase/` and call from a component; keep the mock in place and gate network calls behind a feature flag or environment check.
- Update serverless KV storage: `src/supabase/functions/server/kv_store.tsx` is the authoritative helper. Use `get`, `set`, `mget`, `mset` helpers and remember these run in Deno server functions, not in the browser.

Files to read first (high signal)
- `src/App.tsx` — app state, routing, types, and most business logic.
- `src/utils/auth.ts` — mocked authentication logic and demo credentials.
- `src/utils/mockData.ts` — sample data to mirror in demos and tests.
- `src/utils/supabase/client.ts` and `src/supabase/functions/server/kv_store.tsx` — persistence integration points.
- `vite.config.ts` — dependency aliases and dev server port (port 3000).

Notes and limitations
- There are no automated tests included. The primary verification step is to run `npm run dev` and exercise flows in the browser.
- Do not commit secrets. Supabase server functions expect env vars for service role keys; do not add these to the repo.

If unclear or incomplete
- Ask for: preferred persistence (real Supabase vs mocked), deployment target for the Deno functions, and whether to convert mock auth to a real login flow.

End of instructions.
